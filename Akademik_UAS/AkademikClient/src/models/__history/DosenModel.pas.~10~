unit DosenModel;

interface

uses
  System.JSON, ApiClient;

type
  TDosenModel = class
  public
    class function GetAll: TJSONArray;
    class function Insert(Kode, Nama: string): Boolean;
    class function Update(Kode, Nama: string): Boolean;
    class function Delete(Kode: string): Boolean;
  end;

implementation

class function TDosenModel.GetAll: TJSONArray;
var
  Res: TJSONObject;
begin
  Res := TApiClient.Get('/admin/list_dosen.php');
  Result := Res.GetValue('data') as TJSONArray;
end;

class function TDosenModel.Insert(Kode, Nama: string): Boolean;
var
  Body, Res: TJSONObject;
begin
  Body := TJSONObject.Create;
  try
    Body.AddPair('nidn', Kode);
    Body.AddPair('nama', Nama);

    Res := TApiClient.Post('/admin/insert_dosen.php', Body);
    Result := Res.GetValue('status').AsType<Boolean>;
  finally
    Body.Free;
  end;
end;

class function TDosenModel.Update(Kode, Nama: string): Boolean;
var
  Body, Res: TJSONObject;
begin
  Body := TJSONObject.Create;
  try
    Body.AddPair('nidn', Kode);
    Body.AddPair('nama', Nama);

    Res := TApiClient.Post('/admin/update_dosen.php', Body);
    Result := Res.GetValue('status').AsType<Boolean>;
  finally
    Body.Free;
  end;
end;

class function TDosenModel.Delete(Kode: string): Boolean;
var
  Body, Res: TJSONObject;
begin
  Body := TJSONObject.Create;
  try
    Body.AddPair('nidn', Kode);

    Res := TApiClient.Post('/admin/delete_dosen.php', Body);
    Result := Res.GetValue('status').AsType<Boolean>;
  finally
    Body.Free;
  end;
end;

end.

